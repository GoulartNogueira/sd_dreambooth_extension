<div class="module" id="moduleDreambooth">
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="card shadow">
                    <div class="card-body text-center justify-between">
                        <button class="btn btn-top btn-secondary dbSettingBtn" type="button" id="db_load_params">Load Settings
                        </button>
                        <button class="btn btn-top btn-secondary dbSettingBtn" type="button" id="db_save_config">Save Settings
                        </button>
                        <button class="btn btn-top btn-primary dbSettingBtn" type="button" id="db_train">Train</button>
                        <button class="btn btn-top btn-secondary dbSettingBtn" type="button" id="db_gen_ckpt">Generate Ckpt</button>
                        <button class="btn btn-top btn-secondary hide dbTrainBtn" type="button" id="db_gen_ckpt_during">Save
                            Weights
                        </button>
                        <button class="btn btn-top btn-secondary hide dbTrainBtn" type="button" id="db_train_sample">Generate
                            Samples
                        </button>
                        <button class="btn btn-top btn-secondary hide cancelButton dbTrainBtn" type="button" id="db_cancel">Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12 col-md-6 col-lg-4" id="dbModelCol">
            <div class="col-12 col-md-6 col-lg-4">
                <div class="card shadow d-lg-none d-md-block" id="dreamStatusSm">
                    <div class="card-header">
                        Output
                    </div>
                    <div class="card-body">
                        <div class="progressGroup" id="dreamProgressSm"></div>
                        <div class="image-container inline-gallery-container" id="dreamGallerySm"></div>
                    </div>
                </div>
                <div class="card shadow" id="dreamModel">
                    <div class="card-header">Model</div>
                    <div class="card-body">
                        <ul class="nav nav-tabs" id="myTab" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="db-model-select-tab" data-bs-toggle="tab"
                                        data-bs-target="#db-model-select" type="button" role="tab"
                                        aria-controls="db-model-select"
                                        aria-selected="true">Select
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="db-model-create-tab" data-bs-toggle="tab"
                                        data-bs-target="#db-model-create"
                                        type="button" role="tab" aria-controls="profile" aria-selected="false">Create
                                </button>
                            </li>
                        </ul>
                        <div class="borderSection" id="myTabContent">
                            <div class="tab-pane fade show active" id="db-model-select" role="tabpanel"
                                 aria-labelledby="db-model-select">

                                <div class="container">
                                    <div class="row">
                                        <div class="col-12">
                                            <div id="dreamModelSelect" class="modelSelect" data-model_type="dreambooth"
                                                 data-label="Select Model"></div>
                                        </div>
                                        <div class="col-12">
                                            <div id="snapshotSelect" class="modelSelect db_advanced"
                                                 data-model_type="dreamboothSnapshot"
                                                 data-label="Snapshot to Resume"></div>
                                        </div>
                                    </div>
                                    <div class="row" style="display: none;" id="loraSelect">
                                        <div class="col-12">
                                            <div id="loraModelSelect" class="modelSelect" data-model_type="lora"
                                                 data-label="Lora Model"></div>
                                        </div>
                                    </div>
                                    <div class="row" id="modelDetails">
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="db-model-create" role="tabpanel"
                                 aria-labelledby="db-model-create">
                                <form>
                                    <div class="form-group">
                                        <label class="form-label" for="db_new_model_name">Name</label>
                                        <input type="text" class="form-control newModelParam"
                                               id="db_new_model_name" data-key="new_model_name">
                                    </div>
                                    <div class="form-group">
                                        <div class="form-check form-switch">
                                            <input class="newModelParam form-check-input" type="checkbox" id="512_model" name="512_model" data-key="512_model" checked>
                                            <label class="form-check-label" for="512_model">512x Base Model</label>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-6 db_adv">
                                            <div class="form-group">
                                                <div class="form-check form-switch">
                                                    <input class="form-check-input newModelParam" type="checkbox" id="create_from_hub"
                                                           name="create_from_hub" data-key="create_from_hub">
                                                    <label class="form-check-label" for="create_from_hub">Create From Hub</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="form-group">
                                                <div class="form-check form-switch">
                                                    <input class="form-check-input newModelParam" type="checkbox" id="512_model"
                                                           name="512_model" data-key="512_model" checked>
                                                    <label class="form-check-label" for="512_model">512x Model</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group db_advanced" style="display: none;" id="hub_row">
                                        <label class="form-label" for="db_new_model_url">Model Path</label>
                                        <input type="text" class="form-control newModelParam"
                                               id="db_new_model_url"
                                               placeholder="runwayml/stable-diffusion-v1-5"
                                               data-key="new_model_url">
                                        <label class="form-label" for="db_new_model_token">HuggingFace Token</label>
                                        <input type="text" class="form-control newModelParam"
                                               id="db_new_model_token" data-key="new_model_token"
                                               value="">
                                    </div>
                                    <div class="form-group" id="local_row">
                                        <div class="modelSelect"
                                             id="db_new_model"
                                             data-add_class="newModelParam"
                                             data-model_type="diffusers"
                                             data-label="Source Checkpoint"
                                             data-key="new_model_src"></div>
                                    </div>
                                    <div class="form-group db-advanced">
                                        <div class="form-check form-switch">
                                            <input class="newModelParam form-check-input" type="checkbox" id="db_use_shared_src" name="use_shared_src" data-key="use_shared_src">
                                            <label class="form-check-label" for="db_use_shared_src">Use Shared Base Model (Lora)</label>
                                        </div>
                                    </div>
                                    <div class="form-group" id="shared_row" style="display: none">
                                        <div class="sharedModelSelect modelSelect"
                                             id="new_model_shared_src"
                                             data-add_class="newModelParam"
                                             data-model_type="diffusers"
                                             data-label="LoRA Shared Diffusers Source"
                                             data-key="new_model_shared_src"></div>
                                    </div>
                                    <div class="form-group">
                                        <div class="form-check form-switch">
                                            <input class="newModelParam form-check-input" type="checkbox" id="db_new_model_extract_ema" name="new_model_extract_ema" data-key="new_model_extract_ema">
                                            <label class="form-check-label" for="db_new_model_extract_ema">Extract EMA</label>
                                        </div>                                            
                                    </div>
                                    <div class="form-group">
                                        <div class="form-check form-switch">
                                            <input class="newModelParam form-check-input" type="checkbox" id="db_train_unfrozen" data-key=="train_unfrozen" name="train_unfrozen" checked>
                                            <label class="form-check-label" for="db_train_unfrozen">Unfreeze</label>
                                        </div>
                                    </div>
                                    <div class="form-group text-center">
                                        <button class="btn btn-primary" type="button" id="db_create_model">Create Model</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-6 col-lg-4">
                <div class="card shadow" id="dreamSettings">
                    <div class="card-header">
                        Input
                    </div>
                    <div class="card-body">
                        <div class="borderSection">
                            <div class="row justify-content-between">
                                <div class="col-auto sectionLabel">Concepts</div>
                                <div class="col-auto db-advanced" id="conceptControls">
                                    <button type="button" class="btn btn-primary btn-sm" id="db_concept_add">+</button>
                                    <button type="button" class="btn btn-danger btn-sm hide" id="db_concept_remove">-
                                    </button>
                                </div>
                            </div>

                            <div id="advancedConcepts" class="form-control"></div>
                        </div>
                        <div class="borderSection">
                            <div class="sectionLabel">Settings</div>
                            <div class="db-slider dbInput" data-elem_id="num_train_epochs" data-max="1000" data-min="1"
                                 data-value="150" data-label="Number of Epochs"></div>
                            <div class="db-slider dbInput db-advanced" data-elem_id="save_embedding_every"
                                 data-max="100"
                                 data-min="0" data-step="1"
                                 data-value="0" data-label="Save Weight Frequency (epochs)"></div>
                            <div class="db-slider dbInput db-advanced" data-elem_id="save_preview_every" data-max="100"
                                 data-min="0" data-step="1"
                                 data-value="0" data-label="Save Preview Frequency (epochs)"></div>
                            <div class="db-slider dbInput" data-elem_id="resolution" data-max="1024" data-min="512"
                                 data-step="64"
                                 data-value="768" data-label="Maximum Resolution"></div>
                            <div class="db-slider dbInput" data-elem_id="train_batch_size" data-max="100" data-min="1"
                                 data-step="1"
                                 data-value="5" data-label="Batch Size"></div>
                            <div class="db-slider dbInput" data-elem_id="gradient_accumulation_steps" data-max="100"
                                 data-min="1" data-step="1"
                                 data-value="1" data-label="Gradient Accumulation Steps"></div>
                        </div>
                        <div class="borderSection accordion db-advanced" id="dbAdvancedAccordion">
                            <div class="accordion-item">
                                <div id="dbAdvancedLabel" class="sectionLabel accordion-button collapsed" type="button"
                                     data-bs-toggle="collapse" data-bs-target="#dbAdvancedSettings"
                                     aria-expanded="false" aria-controls="dbAdvancedSettings">Advanced
                                </div>
                                <div id="dbAdvancedSettings" class="accordion-collapse collapse"
                                     aria-labelledby="dbAdvancedLabel" data-bs-parent="#dbAdvancedAccordion">
                                    <div class="accordion-body">
                                        <form>
                                            <div class="form-group">
                                                <label class="form-label" for="attention">Attention</label>
                                                <select class="dbInput form-control" id="attention" name="attention">
                                                    <option value="default">Default</option>
                                                    <option value="xformers" selected>Xformers</option>
                                                </select>
                                            </div>

                                            <div class="form-group">
                                                <label for="learning_rate">Learning Rate</label>
                                                <input class="dbInput form-control" type="number" id="learning_rate"
                                                       name="learning_rate" value="0.000002">
                                            </div>

                                            <div class="form-group">
                                                <div class="dbInput db-slider" data-min="0" data-max="10000"
                                                     data-step="1" data-elem_id="lr_warmup_steps" data-value="500"
                                                     data-label="LR Warmup Steps"></div>
                                            </div>

                                            <div class="form-group">
                                                <div class="dbInput db-slider" data-min="75" data-max="300"
                                                     data-step="75" data-elem_id="max_token_length" data-value="75"
                                                     data-label="Max Token length"></div>
                                            </div>

                                            <div class="form-group">
                                                <label class="form-label" for="mixed_precision">Mixed Precision</label>
                                                <select class="dbInput form-control" id="mixed_precision"
                                                        name="mixed_precision">
                                                    <option value="no">Full (FP32)</option>
                                                    <option value="fp16">FP16</option>
                                                    <option value="bf16" selected>BF16</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <div class="dbInput db-slider" data-min="0" data-max="1.0"
                                                     data-step="0.01" data-elem_id="stop_text_encoder"
                                                     data-value="1.0"
                                                     data-label="Text Encoder Percentage"></div>
                                            </div>
                                            <div class="form-group">
                                                <div class="form-check form-switch">
                                                    <input class="form-check-input" type="checkbox" id="shuffle_tags"
                                                           name="shuffle_tags" checked>
                                                    <label class="form-check-label" for="shuffle_tags">Shuffle
                                                        Tags</label>

                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <div class="form-check form-switch">
                                                    <input class="form-check-input" type="checkbox" id="strict_tokens"
                                                           name="strict_tokens" checked>
                                                    <label class="form-check-label" for="strict_tokens">Strict Tokens</label>

                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <div class="form-check form-switch">
                                                    <input class="form-check-input" type="checkbox"
                                                           id="gradient_checkpointing"
                                                           name="gradient_checkpointing">
                                                    <label class="form-check-label" for="gradient_checkpointing">Gradient
                                                        Checkpointing</label>

                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <div class="form-check form-switch">
                                                    <input class="form-check-input" type="checkbox"
                                                           id="freeze_clip_normalization"
                                                           name="gradient_checkpointing">
                                                    <label class="form-check-label" for="freeze_clip_normalization">Freeze
                                                        CLIP Normalization</label>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-14 col-md-6 col-lg-4">
        <div class="card shadow d-md-none d-lg-block" id="dreamStatus">
            <div class="card-header">
                Output
            </div>
            <div class="card-body">
                <div class="progressGroup" id="dreamProgress"></div>
                <div class="image-container inline-gallery-container" id="dreamGallery"></div>
            </div>
        </div>
    </div>
</div>
</div>
</div>
</div>
</div>